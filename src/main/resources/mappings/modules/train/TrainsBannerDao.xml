<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.training.modules.train.dao.TrainsBannerDao">
    
	<insert id="insert">
		INSERT INTO train_advert(
			ad_name,
			ad_type,
			ad_pic,
			ad_url,
			remark,
			sort,
			del_flag,
			create_time
		) VALUES (
			#{adName},
			#{adType},
			#{adPic},
			#{adUrl},
			#{remark},
			#{sort},
			#{DEL_FLAG_DELETE},
			SYSDATE()
		)
	</insert>
	<select id="findList" resultType="TrainsBanner">
		SELECT
			a.ad_id AS adId,
			a.ad_name AS adName,
			a.ad_type AS adType,
			a.ad_pic AS adPic,
			a.sort,
			a.del_flag,
			c.id AS "dict.id",
			c.label AS "dict.label",
			c.type AS "dict.type",
			c.description AS "dict.description",
			c.sort AS "dict.sort",
			c.parent_id AS "dict.parentId",
			c.create_by AS "dict.createBy",
			c.create_date AS "dict.createDate",
			c.update_by AS "dict.updateBy",
			c.update_date AS "dict.updateDate",
			c.remarks AS "dict.remarks",
			c.del_flag AS "dict.delFlag"
		FROM
			train_advert a
		LEFT JOIN 
			sys_dict c 
		ON 
			a.ad_type = c.value
		WHERE 
			c.type = 'banner_type' 
		AND 
			c.del_flag = 0
		ORDER BY
			sort DESC
	</select>
	<select id="getBanner" resultType="TrainsBanner">
		SELECT
			a.ad_id AS adId,
			a.ad_name AS adName,
			a.ad_type AS adType,
			a.ad_pic AS adPic,
			a.ad_url AS adUrl,
			a.remark,
			a.sort,
			c.id AS "dict.id",
			c.label AS "dict.label",
			c.type AS "dict.type",
			c.description AS "dict.description",
			c.sort AS "dict.sort",
			c.parent_id AS "dict.parentId",
			c.create_by AS "dict.createBy",
			c.create_date AS "dict.createDate",
			c.update_by AS "dict.updateBy",
			c.update_date AS "dict.updateDate",
			c.remarks AS "dict.remarks",
			c.del_flag AS "dict.delFlag"	
		FROM
			train_advert a
		LEFT JOIN 
			sys_dict c 
		ON 
			a.ad_type = c.value
		WHERE 
			c.type = 'banner_type' 
		AND 
			c.del_flag = 0
		AND
			ad_id = #{adId}
	</select>
	<update id="update">
		UPDATE train_advert
			SET 
			  ad_name = #{adName},
			  ad_type = #{adType},
			  ad_pic = #{adPic},
			  ad_url = #{adUrl},
			  remark = #{remark},
			  sort = #{sort},
			  del_flag = 1
			WHERE ad_id = #{adId}
	</update>
	<update id="deleteBanner">
		UPDATE train_advert
			SET 
			  del_flag = #{flag }
			WHERE ad_id = #{adId}
	</update>
</mapper>